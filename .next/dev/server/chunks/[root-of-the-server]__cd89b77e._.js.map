{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 62, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/saksham/OneDrive/Desktop/web/SafeSpeak/src/lib/admin.ts"],"sourcesContent":["import { getApps, initializeApp, type App, cert } from \"firebase-admin/app\";\nimport { getFirestore, type Firestore } from \"firebase-admin/firestore\";\n\ntype ServiceAccount = {\n  project_id: string;\n  client_email: string;\n  private_key: string;\n  [key: string]: unknown;\n};\n\nlet cachedApp: App | undefined;\n\nfunction parseServiceAccount(): ServiceAccount {\n  const raw = process.env.FIREBASE_SERVICE_ACCOUNT;\n  if (!raw) {\n    throw new Error(\"FIREBASE_SERVICE_ACCOUNT environment variable is not set.\");\n  }\n\n  try {\n    const parsed = JSON.parse(raw) as ServiceAccount;\n    if (!parsed.project_id || !parsed.client_email || !parsed.private_key) {\n      throw new Error(\"Missing required fields in service account JSON.\");\n    }\n    return parsed;\n  } catch (error) {\n    const message = error instanceof Error ? error.message : String(error);\n    throw new Error(`Failed to parse FIREBASE_SERVICE_ACCOUNT: ${message}`);\n  }\n}\n\nexport function getAdminApp(): App {\n  if (cachedApp) {\n    return cachedApp;\n  }\n\n  if (getApps().length > 0) {\n    cachedApp = getApps()[0];\n    return cachedApp;\n  }\n\n  const serviceAccount = parseServiceAccount();\n\n  cachedApp = initializeApp({\n    credential: cert(serviceAccount),\n  });\n\n  return cachedApp;\n}\n\nexport function getAdminDb(): Firestore {\n  const app = getAdminApp();\n  return getFirestore(app);\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;;;;;;AASA,IAAI;AAEJ,SAAS;IACP,MAAM,MAAM,QAAQ,GAAG,CAAC,wBAAwB;IAChD,IAAI,CAAC,KAAK;QACR,MAAM,IAAI,MAAM;IAClB;IAEA,IAAI;QACF,MAAM,SAAS,KAAK,KAAK,CAAC;QAC1B,IAAI,CAAC,OAAO,UAAU,IAAI,CAAC,OAAO,YAAY,IAAI,CAAC,OAAO,WAAW,EAAE;YACrE,MAAM,IAAI,MAAM;QAClB;QACA,OAAO;IACT,EAAE,OAAO,OAAO;QACd,MAAM,UAAU,iBAAiB,QAAQ,MAAM,OAAO,GAAG,OAAO;QAChE,MAAM,IAAI,MAAM,CAAC,0CAA0C,EAAE,SAAS;IACxE;AACF;AAEO,SAAS;IACd,IAAI,WAAW;QACb,OAAO;IACT;IAEA,IAAI,IAAA,2JAAO,IAAG,MAAM,GAAG,GAAG;QACxB,YAAY,IAAA,2JAAO,GAAE,CAAC,EAAE;QACxB,OAAO;IACT;IAEA,MAAM,iBAAiB;IAEvB,YAAY,IAAA,iKAAa,EAAC;QACxB,YAAY,IAAA,wJAAI,EAAC;IACnB;IAEA,OAAO;AACT;AAEO,SAAS;IACd,MAAM,MAAM;IACZ,OAAO,IAAA,4KAAY,EAAC;AACtB","debugId":null}},
    {"offset": {"line": 119, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/saksham/OneDrive/Desktop/web/SafeSpeak/src/app/api/resources/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport { getAdminDb } from \"@/lib/admin\";\n\n// Duplicate of CITY_MAP from geo.ts for server-side use\nconst CITY_MAP: Record<string, { lat: number; lng: number }> = {\n  delhi: { lat: 28.6139, lng: 77.2090 },\n  mumbai: { lat: 19.0760, lng: 72.8777 },\n  chennai: { lat: 13.0827, lng: 80.2707 },\n  hyderabad: { lat: 17.3850, lng: 78.4867 },\n};\n\nfunction getCityCoords(region?: string): { lat: number | null; lng: number | null } {\n  if (!region) return { lat: null, lng: null };\n  \n  // Normalize region name (lowercase, no spaces)\n  const normalized = region.toLowerCase().replace(/\\s+/g, '');\n  const coords = CITY_MAP[normalized];\n  \n  return coords ? { lat: coords.lat, lng: coords.lng } : { lat: null, lng: null };\n}\n\ntype NgoRecord = {\n  name?: unknown;\n  services?: unknown;\n  languages?: unknown;\n  verified?: unknown;\n  contact?: unknown;\n  region?: unknown;\n  lat?: unknown;\n  lng?: unknown;\n};\n\nfunction methodNotAllowed() {\n  return new NextResponse(\"Method not allowed.\", {\n    status: 405,\n    headers: {\n      Allow: \"GET\",\n    },\n  });\n}\n\nexport const POST = methodNotAllowed;\nexport const PUT = methodNotAllowed;\nexport const DELETE = methodNotAllowed;\n\nfunction normalizeStrings(value: unknown): string[] {\n  if (!Array.isArray(value)) {\n    return [];\n  }\n\n  return value\n    .map((entry) => (typeof entry === \"string\" ? entry : null))\n    .filter((entry): entry is string => entry !== null);\n}\n\nfunction normalizeBoolean(value: unknown): boolean {\n  if (typeof value === \"boolean\") {\n    return value;\n  }\n  return false;\n}\n\nfunction normalizeOptionalString(value: unknown): string | undefined {\n  if (typeof value === \"string\" && value.trim().length > 0) {\n    return value;\n  }\n  return undefined;\n}\n\nexport async function GET() {\n  try {\n    const db = getAdminDb();\n    const snapshot = await db.collection(\"ngos\").get();\n\n    const ngos = snapshot.docs.map((doc) => {\n      const data = doc.data() as NgoRecord | undefined;\n      const region = normalizeOptionalString(data?.region);\n      \n      // Get coordinates, with fallback to city coordinates if available\n      let lat: number | null = null;\n      let lng: number | null = null;\n      \n      // Check if lat/lng exist and are valid numbers\n      if (typeof data?.lat === 'number' && !isNaN(data.lat) && \n          typeof data?.lng === 'number' && !isNaN(data.lng)) {\n        lat = data.lat;\n        lng = data.lng;\n      } \n      // Fallback to city coordinates if available\n      else if (region) {\n        const cityCoords = getCityCoords(region);\n        lat = cityCoords.lat;\n        lng = cityCoords.lng;\n      }\n\n      return {\n        id: doc.id,\n        name: typeof data?.name === \"string\" ? data.name : \"\",\n        services: normalizeStrings(data?.services),\n        languages: normalizeStrings(data?.languages),\n        verified: normalizeBoolean(data?.verified),\n        contact: normalizeOptionalString(data?.contact),\n        region,\n        lat,\n        lng,\n      };\n    });\n\n    return NextResponse.json(ngos, { status: 200 });\n  } catch (error) {\n    console.error(\"Resources route error:\", error instanceof Error ? error.message : error);\n    return NextResponse.json({ error: \"server error\" }, { status: 500 });\n  }\n}\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA;;;;;;;AAEA,wDAAwD;AACxD,MAAM,WAAyD;IAC7D,OAAO;QAAE,KAAK;QAAS,KAAK;IAAQ;IACpC,QAAQ;QAAE,KAAK;QAAS,KAAK;IAAQ;IACrC,SAAS;QAAE,KAAK;QAAS,KAAK;IAAQ;IACtC,WAAW;QAAE,KAAK;QAAS,KAAK;IAAQ;AAC1C;AAEA,SAAS,cAAc,MAAe;IACpC,IAAI,CAAC,QAAQ,OAAO;QAAE,KAAK;QAAM,KAAK;IAAK;IAE3C,+CAA+C;IAC/C,MAAM,aAAa,OAAO,WAAW,GAAG,OAAO,CAAC,QAAQ;IACxD,MAAM,SAAS,QAAQ,CAAC,WAAW;IAEnC,OAAO,SAAS;QAAE,KAAK,OAAO,GAAG;QAAE,KAAK,OAAO,GAAG;IAAC,IAAI;QAAE,KAAK;QAAM,KAAK;IAAK;AAChF;AAaA,SAAS;IACP,OAAO,IAAI,2LAAY,CAAC,uBAAuB;QAC7C,QAAQ;QACR,SAAS;YACP,OAAO;QACT;IACF;AACF;AAEO,MAAM,OAAO;AACb,MAAM,MAAM;AACZ,MAAM,SAAS;AAEtB,SAAS,iBAAiB,KAAc;IACtC,IAAI,CAAC,MAAM,OAAO,CAAC,QAAQ;QACzB,OAAO,EAAE;IACX;IAEA,OAAO,MACJ,GAAG,CAAC,CAAC,QAAW,OAAO,UAAU,WAAW,QAAQ,MACpD,MAAM,CAAC,CAAC,QAA2B,UAAU;AAClD;AAEA,SAAS,iBAAiB,KAAc;IACtC,IAAI,OAAO,UAAU,WAAW;QAC9B,OAAO;IACT;IACA,OAAO;AACT;AAEA,SAAS,wBAAwB,KAAc;IAC7C,IAAI,OAAO,UAAU,YAAY,MAAM,IAAI,GAAG,MAAM,GAAG,GAAG;QACxD,OAAO;IACT;IACA,OAAO;AACT;AAEO,eAAe;IACpB,IAAI;QACF,MAAM,KAAK,IAAA,8KAAU;QACrB,MAAM,WAAW,MAAM,GAAG,UAAU,CAAC,QAAQ,GAAG;QAEhD,MAAM,OAAO,SAAS,IAAI,CAAC,GAAG,CAAC,CAAC;YAC9B,MAAM,OAAO,IAAI,IAAI;YACrB,MAAM,SAAS,wBAAwB,MAAM;YAE7C,kEAAkE;YAClE,IAAI,MAAqB;YACzB,IAAI,MAAqB;YAEzB,+CAA+C;YAC/C,IAAI,OAAO,MAAM,QAAQ,YAAY,CAAC,MAAM,KAAK,GAAG,KAChD,OAAO,MAAM,QAAQ,YAAY,CAAC,MAAM,KAAK,GAAG,GAAG;gBACrD,MAAM,KAAK,GAAG;gBACd,MAAM,KAAK,GAAG;YAChB,OAEK,IAAI,QAAQ;gBACf,MAAM,aAAa,cAAc;gBACjC,MAAM,WAAW,GAAG;gBACpB,MAAM,WAAW,GAAG;YACtB;YAEA,OAAO;gBACL,IAAI,IAAI,EAAE;gBACV,MAAM,OAAO,MAAM,SAAS,WAAW,KAAK,IAAI,GAAG;gBACnD,UAAU,iBAAiB,MAAM;gBACjC,WAAW,iBAAiB,MAAM;gBAClC,UAAU,iBAAiB,MAAM;gBACjC,SAAS,wBAAwB,MAAM;gBACvC;gBACA;gBACA;YACF;QACF;QAEA,OAAO,2LAAY,CAAC,IAAI,CAAC,MAAM;YAAE,QAAQ;QAAI;IAC/C,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,0BAA0B,iBAAiB,QAAQ,MAAM,OAAO,GAAG;QACjF,OAAO,2LAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAe,GAAG;YAAE,QAAQ;QAAI;IACpE;AACF","debugId":null}}]
}